<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Chatbot API Documentation</title>
    <style>
        @page {
            size: A4;
            margin: 2cm;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.5;
            color: #333;
            max-width: 21cm;
            margin: 0 auto;
            padding: 1.5cm;
            background: white;
            font-size: 11pt;
        }
        
        .header {
            border-bottom: 3px solid #667eea;
            padding-bottom: 15px;
            margin-bottom: 25px;
        }
        
        h1 {
            color: #667eea;
            font-size: 24pt;
            margin: 0 0 8px 0;
            font-weight: 700;
        }
        
        .subtitle {
            color: #666;
            font-size: 11pt;
            font-style: italic;
        }
        
        h2 {
            color: #667eea;
            font-size: 16pt;
            margin: 25px 0 12px 0;
            padding-bottom: 6px;
            border-bottom: 2px solid #e0e0e0;
            page-break-after: avoid;
        }
        
        h3 {
            color: #555;
            font-size: 13pt;
            margin: 18px 0 10px 0;
            font-weight: 600;
            page-break-after: avoid;
        }
        
        h4 {
            color: #667eea;
            font-size: 11pt;
            margin: 12px 0 8px 0;
            font-weight: 600;
        }
        
        p {
            margin: 8px 0;
            text-align: justify;
        }
        
        ul, ol {
            margin: 8px 0;
            padding-left: 22px;
        }
        
        li {
            margin: 5px 0;
        }
        
        .endpoint-box {
            background: #f8f9ff;
            border: 2px solid #667eea;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            page-break-inside: avoid;
        }
        
        .method-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 10pt;
            margin-right: 10px;
        }
        
        .method-get { background: #10b981; color: white; }
        .method-post { background: #3b82f6; color: white; }
        .method-put { background: #f59e0b; color: white; }
        .method-delete { background: #ef4444; color: white; }
        
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            border-left: 3px solid #667eea;
            padding: 15px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 9.5pt;
            margin: 12px 0;
            overflow-x: auto;
            page-break-inside: avoid;
            border-radius: 4px;
        }
        
        .code-block pre {
            margin: 0;
            white-space: pre;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
            font-size: 10pt;
            page-break-inside: avoid;
        }
        
        th {
            background: #667eea;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: 600;
            font-size: 10pt;
        }
        
        td {
            padding: 8px;
            border-bottom: 1px solid #e0e0e0;
            vertical-align: top;
        }
        
        .param-required {
            color: #ef4444;
            font-weight: bold;
            font-size: 9pt;
        }
        
        .param-optional {
            color: #10b981;
            font-weight: bold;
            font-size: 9pt;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 12px 15px;
            margin: 12px 0;
            page-break-inside: avoid;
        }
        
        .warning-box {
            background: #fff8e1;
            border-left: 4px solid #ffa726;
            padding: 12px 15px;
            margin: 12px 0;
            page-break-inside: avoid;
        }
        
        .success-box {
            background: #e8f5e9;
            border-left: 4px solid #66bb6a;
            padding: 12px 15px;
            margin: 12px 0;
            page-break-inside: avoid;
        }
        
        .error-box {
            background: #ffebee;
            border-left: 4px solid #ef4444;
            padding: 12px 15px;
            margin: 12px 0;
            page-break-inside: avoid;
        }
        
        .status-code {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 9pt;
            font-family: monospace;
        }
        
        .status-200 { background: #e8f5e9; color: #2e7d32; }
        .status-201 { background: #e8f5e9; color: #2e7d32; }
        .status-400 { background: #fff8e1; color: #f57c00; }
        .status-401 { background: #ffebee; color: #c62828; }
        .status-403 { background: #ffebee; color: #c62828; }
        .status-404 { background: #ffebee; color: #c62828; }
        .status-429 { background: #fff8e1; color: #f57c00; }
        .status-500 { background: #ffebee; color: #c62828; }
        
        .footer {
            margin-top: 30px;
            padding-top: 15px;
            border-top: 2px solid #e0e0e0;
            font-size: 9pt;
            color: #666;
            text-align: center;
        }
        
        .json-key { color: #9cdcfe; }
        .json-string { color: #ce9178; }
        .json-number { color: #b5cea8; }
        .json-boolean { color: #569cd6; }
        .json-null { color: #569cd6; }
        
        @media print {
            body { padding: 0; }
            .page-break { page-break-before: always; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Payment Chatbot API Documentation</h1>
        <p class="subtitle">RESTful API Reference - Version 1.0</p>
    </div>

    <div class="info-box">
        <strong>Base URL:</strong> <code>https://api.paymentchatbot.com/v1</code><br>
        <strong>Protocol:</strong> HTTPS only<br>
        <strong>Content-Type:</strong> application/json (unless specified otherwise)
    </div>

    <h2>1. Authentication Flow</h2>

    <h3>1.1 Authentication Overview</h3>
    <p>The Payment Chatbot API uses API Key authentication with Bearer token format. All requests must include a valid API key in the Authorization header.</p>

    <h3>1.2 Obtaining API Keys</h3>
    <p>API keys are issued through the developer portal at <code>https://portal.paymentchatbot.com</code>. Each organization receives:</p>
    <ul>
        <li><strong>Development Key:</strong> Rate-limited, sandbox environment access</li>
        <li><strong>Production Key:</strong> Full access with higher rate limits</li>
    </ul>

    <h3>1.3 Authentication Header Format</h3>
    <div class="code-block"><pre>Authorization: Bearer YOUR_API_KEY_HERE</pre></div>

    <h3>1.4 Example Authentication Request</h3>
    <div class="code-block"><pre>curl -X POST https://api.paymentchatbot.com/v1/chat \
  -H <span class="json-string">"Authorization: Bearer sk_live_abc123xyz789"</span> \
  -H <span class="json-string">"Content-Type: application/json"</span> \
  -d '{
    <span class="json-key">"query"</span>: <span class="json-string">"What are the KYC requirements?"</span>,
    <span class="json-key">"role"</span>: <span class="json-string">"compliance_lead"</span>
  }'</pre></div>

    <div class="warning-box">
        <strong>Security Best Practices:</strong>
        <ul style="margin: 5px 0;">
            <li>Never expose API keys in client-side code or public repositories</li>
            <li>Rotate keys every 90 days</li>
            <li>Use environment variables to store keys</li>
            <li>Implement key rotation without downtime using dual-key periods</li>
        </ul>
    </div>

    <h2>2. Rate Limiting</h2>

    <h3>2.1 Rate Limit Tiers</h3>
    <table>
        <tr>
            <th>Tier</th>
            <th>Requests/Minute</th>
            <th>Requests/Hour</th>
            <th>Requests/Day</th>
        </tr>
        <tr>
            <td>Development</td>
            <td>10</td>
            <td>100</td>
            <td>1,000</td>
        </tr>
        <tr>
            <td>Production Basic</td>
            <td>60</td>
            <td>1,000</td>
            <td>10,000</td>
        </tr>
        <tr>
            <td>Production Premium</td>
            <td>300</td>
            <td>5,000</td>
            <td>50,000</td>
        </tr>
        <tr>
            <td>Enterprise</td>
            <td>Custom</td>
            <td>Custom</td>
            <td>Custom</td>
        </tr>
    </table>

    <h3>2.2 Rate Limit Headers</h3>
    <p>Every API response includes rate limit information in the headers:</p>
    <div class="code-block"><pre>X-RateLimit-Limit: 60
X-RateLimit-Remaining: 45
X-RateLimit-Reset: 1735920000</pre></div>

    <table>
        <tr>
            <th>Header</th>
            <th>Description</th>
        </tr>
        <tr>
            <td><code>X-RateLimit-Limit</code></td>
            <td>Maximum requests allowed per minute</td>
        </tr>
        <tr>
            <td><code>X-RateLimit-Remaining</code></td>
            <td>Number of requests remaining in current window</td>
        </tr>
        <tr>
            <td><code>X-RateLimit-Reset</code></td>
            <td>Unix timestamp when the rate limit resets</td>
        </tr>
    </table>

    <h3>2.3 Rate Limit Exceeded Response</h3>
    <p>When rate limit is exceeded, the API returns <span class="status-code status-429">429 Too Many Requests</span>:</p>
    <div class="code-block"><pre>{
  <span class="json-key">"error"</span>: {
    <span class="json-key">"code"</span>: <span class="json-string">"rate_limit_exceeded"</span>,
    <span class="json-key">"message"</span>: <span class="json-string">"Rate limit exceeded. Please retry after 45 seconds."</span>,
    <span class="json-key">"retry_after"</span>: <span class="json-number">45</span>
  }
}</pre></div>

    <div class="info-box">
        <strong>Retry Strategy:</strong> Implement exponential backoff with jitter. Wait for the time specified in <code>retry_after</code> before retrying.
    </div>

    <div class="page-break"></div>

    <h2>3. Endpoint Specifications</h2>

    <h3>3.1 Chat Query Endpoint</h3>
    <div class="endpoint-box">
        <div>
            <span class="method-badge method-post">POST</span>
            <code style="font-size: 11pt; font-weight: bold;">/chat</code>
        </div>
        <p style="margin-top: 10px;">Submit a query to the chatbot and receive a contextual response based on stakeholder role.</p>
    </div>

    <h4>Request Parameters</h4>
    <table>
        <tr>
            <th>Parameter</th>
            <th>Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
        <tr>
            <td><code>query</code></td>
            <td>string</td>
            <td><span class="param-required">Required</span></td>
            <td>The user's question (max 500 characters)</td>
        </tr>
        <tr>
            <td><code>role</code></td>
            <td>string</td>
            <td><span class="param-optional">Optional</span></td>
            <td>Stakeholder role: <code>product_lead</code>, <code>tech_lead</code>, <code>compliance_lead</code>, <code>bank_alliance_lead</code></td>
        </tr>
        <tr>
            <td><code>top_k</code></td>
            <td>integer</td>
            <td><span class="param-optional">Optional</span></td>
            <td>Number of context chunks to retrieve (default: 3, max: 10)</td>
        </tr>
        <tr>
            <td><code>session_id</code></td>
            <td>string</td>
            <td><span class="param-optional">Optional</span></td>
            <td>Session identifier for conversation tracking</td>
        </tr>
    </table>

    <h4>Request Example</h4>
    <div class="code-block"><pre><span class="json-key">POST</span> /v1/chat
<span class="json-key">Content-Type:</span> application/json
<span class="json-key">Authorization:</span> Bearer sk_live_abc123xyz789

{
  <span class="json-key">"query"</span>: <span class="json-string">"What are the transaction limits for UPI payments?"</span>,
  <span class="json-key">"role"</span>: <span class="json-string">"product_lead"</span>,
  <span class="json-key">"top_k"</span>: <span class="json-number">3</span>,
  <span class="json-key">"session_id"</span>: <span class="json-string">"sess_1234567890"</span>
}</pre></div>

    <h4>Response Example</h4>
    <p><span class="status-code status-200">200 OK</span></p>
    <div class="code-block"><pre>{
  <span class="json-key">"response"</span>: <span class="json-string">"UPI transaction limits are set at ₹1,00,000 per transaction for P2P transfers and ₹2,00,000 for merchant payments. These limits can be customized based on user KYC level and bank policies."</span>,
  <span class="json-key">"confidence"</span>: <span class="json-number">0.87</span>,
  <span class="json-key">"stakeholder"</span>: <span class="json-string">"product_lead"</span>,
  <span class="json-key">"sources"</span>: [
    {
      <span class="json-key">"document"</span>: <span class="json-string">"UPI_Guidelines_2024.pdf"</span>,
      <span class="json-key">"relevance_score"</span>: <span class="json-number">0.92</span>,
      <span class="json-key">"chunk_text"</span>: <span class="json-string">"Transaction limits for UPI are defined..."</span>
    },
    {
      <span class="json-key">"document"</span>: <span class="json-string">"NPCI_Circular_045.pdf"</span>,
      <span class="json-key">"relevance_score"</span>: <span class="json-number">0.85</span>,
      <span class="json-key">"chunk_text"</span>: <span class="json-string">"NPCI mandates maximum transaction values..."</span>
    }
  ],
  <span class="json-key">"metadata"</span>: {
    <span class="json-key">"processing_time_ms"</span>: <span class="json-number">1247</span>,
    <span class="json-key">"model_used"</span>: <span class="json-string">"llama3.2:3b"</span>,
    <span class="json-key">"chunks_retrieved"</span>: <span class="json-number">3</span>
  },
  <span class="json-key">"session_id"</span>: <span class="json-string">"sess_1234567890"</span>
}</pre></div>

    <h3>3.2 Document Upload Endpoint</h3>
    <div class="endpoint-box">
        <div>
            <span class="method-badge method-post">POST</span>
            <code style="font-size: 11pt; font-weight: bold;">/documents/upload</code>
        </div>
        <p style="margin-top: 10px;">Upload a PDF document for processing and indexing into the knowledge base.</p>
    </div>

    <h4>Request Parameters</h4>
    <table>
        <tr>
            <th>Parameter</th>
            <th>Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
        <tr>
            <td><code>file</code></td>
            <td>file</td>
            <td><span class="param-required">Required</span></td>
            <td>PDF file (max 10MB)</td>
        </tr>
        <tr>
            <td><code>document_type</code></td>
            <td>string</td>
            <td><span class="param-optional">Optional</span></td>
            <td>Document classification override: <code>technical</code>, <code>compliance</code>, <code>business</code>, <code>product</code></td>
        </tr>
        <tr>
            <td><code>stakeholders</code></td>
            <td>array</td>
            <td><span class="param-optional">Optional</span></td>
            <td>Target stakeholder roles who can access this document</td>
        </tr>
    </table>

    <h4>Request Example</h4>
    <div class="code-block"><pre><span class="json-key">POST</span> /v1/documents/upload
<span class="json-key">Content-Type:</span> multipart/form-data
<span class="json-key">Authorization:</span> Bearer sk_live_abc123xyz789

------WebKitFormBoundary
Content-Disposition: form-data; name="file"; filename="KYC_Policy.pdf"
Content-Type: application/pdf

[Binary PDF Data]
------WebKitFormBoundary
Content-Disposition: form-data; name="document_type"

compliance
------WebKitFormBoundary
Content-Disposition: form-data; name="stakeholders"

["compliance_lead", "product_lead"]
------WebKitFormBoundary--</pre></div>

    <h4>Response Example</h4>
    <p><span class="status-code status-201">201 Created</span></p>
    <div class="code-block"><pre>{
  <span class="json-key">"document_id"</span>: <span class="json-string">"doc_9f8e7d6c5b4a"</span>,
  <span class="json-key">"filename"</span>: <span class="json-string">"KYC_Policy.pdf"</span>,
  <span class="json-key">"status"</span>: <span class="json-string">"processing"</span>,
  <span class="json-key">"document_type"</span>: <span class="json-string">"compliance"</span>,
  <span class="json-key">"chunks_created"</span>: <span class="json-number">42</span>,
  <span class="json-key">"vectors_indexed"</span>: <span class="json-number">42</span>,
  <span class="json-key">"processing_time_ms"</span>: <span class="json-number">3456</span>,
  <span class="json-key">"uploaded_at"</span>: <span class="json-string">"2025-10-03T14:30:00Z"</span>
}</pre></div>

    <div class="page-break"></div>

    <h3>3.3 Document Status Endpoint</h3>
    <div class="endpoint-box">
        <div>
            <span class="method-badge method-get">GET</span>
            <code style="font-size: 11pt; font-weight: bold;">/documents/{document_id}</code>
        </div>
        <p style="margin-top: 10px;">Check the processing status and metadata of an uploaded document.</p>
    </div>

    <h4>Path Parameters</h4>
    <table>
        <tr>
            <th>Parameter</th>
            <th>Type</th>
            <th>Description</th>
        </tr>
        <tr>
            <td><code>document_id</code></td>
            <td>string</td>
            <td>Unique document identifier returned from upload</td>
        </tr>
    </table>

    <h4>Response Example</h4>
    <p><span class="status-code status-200">200 OK</span></p>
    <div class="code-block"><pre>{
  <span class="json-key">"document_id"</span>: <span class="json-string">"doc_9f8e7d6c5b4a"</span>,
  <span class="json-key">"filename"</span>: <span class="json-string">"KYC_Policy.pdf"</span>,
  <span class="json-key">"status"</span>: <span class="json-string">"indexed"</span>,
  <span class="json-key">"document_type"</span>: <span class="json-string">"compliance"</span>,
  <span class="json-key">"file_size_bytes"</span>: <span class="json-number">2457600</span>,
  <span class="json-key">"page_count"</span>: <span class="json-number">18</span>,
  <span class="json-key">"chunks_created"</span>: <span class="json-number">42</span>,
  <span class="json-key">"entities_extracted"</span>: {
    <span class="json-key">"organizations"</span>: [<span class="json-string">"RBI"</span>, <span class="json-string">"NPCI"</span>, <span class="json-string">"FATF"</span>],
    <span class="json-key">"dates"</span>: [<span class="json-string">"2024-01-15"</span>, <span class="json-string">"2024-06-30"</span>],
    <span class="json-key">"amounts"</span>: [<span class="json-string">"₹50,000"</span>, <span class="json-string">"₹1,00,000"</span>]
  },
  <span class="json-key">"uploaded_at"</span>: <span class="json-string">"2025-10-03T14:30:00Z"</span>,
  <span class="json-key">"indexed_at"</span>: <span class="json-string">"2025-10-03T14:30:03Z"</span>
}</pre></div>

    <h3>3.4 Health Check Endpoint</h3>
    <div class="endpoint-box">
        <div>
            <span class="method-badge method-get">GET</span>
            <code style="font-size: 11pt; font-weight: bold;">/health</code>
        </div>
        <p style="margin-top: 10px;">Check the operational status of the API and its dependencies.</p>
    </div>

    <h4>Response Example</h4>
    <p><span class="status-code status-200">200 OK</span></p>
    <div class="code-block"><pre>{
  <span class="json-key">"status"</span>: <span class="json-string">"healthy"</span>,
  <span class="json-key">"version"</span>: <span class="json-string">"1.0.0"</span>,
  <span class="json-key">"timestamp"</span>: <span class="json-string">"2025-10-03T14:45:00Z"</span>,
  <span class="json-key">"services"</span>: {
    <span class="json-key">"database"</span>: <span class="json-string">"operational"</span>,
    <span class="json-key">"vector_db"</span>: <span class="json-string">"operational"</span>,
    <span class="json-key">"llm"</span>: <span class="json-string">"operational"</span>,
    <span class="json-key">"embedding_service"</span>: <span class="json-string">"operational"</span>
  },
  <span class="json-key">"response_time_ms"</span>: <span class="json-number">12</span>
}</pre></div>

    <h2>4. Error Handling and Status Codes</h2>

    <h3>4.1 HTTP Status Codes</h3>
    <table>
        <tr>
            <th>Status Code</th>
            <th>Meaning</th>
            <th>Description</th>
        </tr>
        <tr>
            <td><span class="status-code status-200">200</span></td>
            <td>OK</td>
            <td>Request successful</td>
        </tr>
        <tr>
            <td><span class="status-code status-201">201</span></td>
            <td>Created</td>
            <td>Resource created successfully (e.g., document uploaded)</td>
        </tr>
        <tr>
            <td><span class="status-code status-400">400</span></td>
            <td>Bad Request</td>
            <td>Invalid request parameters or malformed JSON</td>
        </tr>
        <tr>
            <td><span class="status-code status-401">401</span></td>
            <td>Unauthorized</td>
            <td>Missing or invalid API key</td>
        </tr>
        <tr>
            <td><span class="status-code status-403">403</span></td>
            <td>Forbidden</td>
            <td>Valid API key but insufficient permissions</td>
        </tr>
        <tr>
            <td><span class="status-code status-404">404</span></td>
            <td>Not Found</td>
            <td>Requested resource does not exist</td>
        </tr>
        <tr>
            <td><span class="status-code status-429">429</span></td>
            <td>Too Many Requests</td>
            <td>Rate limit exceeded</td>
        </tr>
        <tr>
            <td><span class="status-code status-500">500</span></td>
            <td>Internal Server Error</td>
            <td>Server encountered an unexpected error</td>
        </tr>
    </table>

    <h3>4.2 Error Response Format</h3>
    <p>All error responses follow a consistent JSON structure:</p>
    <div class="code-block"><pre>{
  <span class="json-key">"error"</span>: {
    <span class="json-key">"code"</span>: <span class="json-string">"error_code_identifier"</span>,
    <span class="json-key">"message"</span>: <span class="json-string">"Human-readable error description"</span>,
    <span class="json-key">"details"</span>: {
      <span class="json-key">"field"</span>: <span class="json-string">"Additional context about the error"</span>
    },
    <span class="json-key">"timestamp"</span>: <span class="json-string">"2025-10-03T14:30:00Z"</span>,
    <span class="json-key">"request_id"</span>: <span class="json-string">"req_abc123xyz789"</span>
  }
}</pre></div>

    <h3>4.3 Common Error Codes</h3>
    <table>
        <tr>
            <th>Error Code</th>
            <th>HTTP Status</th>
            <th>Description</th>
        </tr>
        <tr>
            <td><code>invalid_api_key</code></td>
            <td>401</td>
            <td>The provided API key is invalid or expired</td>
        </tr>
        <tr>
            <td><code>missing_parameter</code></td>
            <td>400</td>
            <td>A required parameter is missing from the request</td>
        </tr>
        <tr>
            <td><code>invalid_parameter</code></td>
            <td>400</td>
            <td>A parameter value is invalid or out of